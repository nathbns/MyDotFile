#####  ~/.config/tmux/tmux.conf  #############################################

# Utiliser zsh par défaut -----------------------------------------------------
set-environment -g TMUX_THEME onedark
set-environment -g PATH "$HOME/.config:$PATH"
set -g default-shell /bin/zsh

# Couleurs 256 + true-color ---------------------------------------------------
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",*256col*:Tc"

# Réglages généraux -----------------------------------------------------------
set -g set-clipboard on
set -g detach-on-destroy off
set -g escape-time 0
set -g history-limit 1000000
set -g mouse on
set -g status-interval 2          # = --interval 2 ci-dessous
set -g allow-passthrough on

# Préfixe (Ctrl-b) ------------------------------------------------------------
unbind C-b
set -g prefix C-b

# Recharger la conf avec r ----------------------------------------------------
unbind r
bind r source-file ~/.config/tmux/tmux.conf \; display-message "✓ tmux.conf rechargé"

# Splits ----------------------------------------------------------------------
unbind %
bind % split-window -h -c "#{pane_current_path}"
unbind \"                                # guillemet → split vertical
bind -  split-window -v -c "#{pane_current_path}"
bind c  new-window    -c "#{pane_current_path}"

# Redimensionner avec h j k l -------------------------------------------------
bind -r j resize-pane -D 5
bind -r k resize-pane -U 5
bind -r l resize-pane -R 5
bind -r h resize-pane -L 5
bind -r m resize-pane -Z                   # toggle zoom

# Copy-mode (vi) --------------------------------------------------------------
set-window-option -g mode-keys vi
bind-key -T copy-mode-vi v send -X begin-selection
bind-key -T copy-mode-vi y send -X copy-pipe-and-cancel "pbcopy"
bind P paste-buffer
unbind -T copy-mode-vi MouseDragEnd1Pane

# Les fenêtres/panes commencent à 1 ------------------------------------------
set -g base-index 1
set -g pane-base-index 1
set -g renumber-windows on

#####  Plugins (TPM) ##########################################################
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
# le binaire « tmux-mem-cpu-load » est appelé directement (brew install tmux-mem-cpu-load)

#####  Thèmes #################################################################
if-shell "[[ \"$TMUX_THEME\" == \"onedark\" ]]" 'source-file ~/.config/tmux/onedark-theme.conf' ""
if-shell "[[ \"$TMUX_THEME\" == \"nord\" ]]"   'source-file ~/.config/tmux/nord-theme.conf'   ""

#####  Barre d’état : CPU / RAM compact #######################################
#    <cpu%> │  <ram%>
set -g status-right '#(~/.config/tmux/tmux-sysinfo) | %Y-%m-%d %H:%M '

#####  Resurrect / Continuum ###################################################
set -g @resurrect-capture-pane-contents 'on'
# set -g @continuum-restore 'on'

#####  TPM init (keep last) ###################################################
run '~/.config/tmux/plugins/tpm/tpm'

#####  Notes ##################################################################
# • Installe le binaire : brew install tmux-mem-cpu-load
# • Recharge les plugins : <prefix> I
# • Recharge la conf     : <prefix> r
# • Police Nerd Font requise pour  (f4bc) et  (e266)
# • Installe le binaire :  brew install tmux-mem-cpu-load
# • Recharge les plugins : <prefix> I
# • Recharge la conf     : <prefix> r
# • Police Nerd Font requise pour  (f4bc) et  (e266)

